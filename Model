<?xml version="1.0"?>
<sdf version="1.10">
  <model name="arm3dof">
    <plugin filename="libgz-sim-joint-state-publisher-system.so" 
        name="gz::sim::systems::JointStatePublisher">
    <topic>joint_states</topic>
</plugin>
    <static>false</static>

    <!-- base -->
    <link name="base_link">
      <gravity>0</gravity>
      <pose>0 0 0.075 0 0 0</pose>
      <inertial>
        <mass>6.0</mass>
        <inertia>
          <ixx>0.50</ixx>
          <iyy>0.50</iyy>
          <izz>0.10</izz>
          <ixy>0</ixy>
          <ixz>0</ixz>
          <iyz>0</iyz>
        </inertia>
      </inertial>
      <collision name="base_collision">
        <geometry>
          <box>
            <size>0.6 0.6 0.15</size>
          </box>
        </geometry>
      </collision>
      <visual name="base_visual">
        <material>
          <ambient>0.0 0.0 0.5 1</ambient> <diffuse>0.0 0.0 0.5 1</diffuse>
        </material>
        <geometry>
          <box>
            <size>0.6 0.6 0.15</size>
          </box>
        </geometry>
      </visual>
    </link>

    <!--1. link -->
    <link name="link1">
      <gravity>0</gravity>
      <pose>0 0 0.6 0 0 0</pose>
      <inertial>
        <mass>3.0</mass>
        <inertia>
          <ixx>0.25</ixx>
          <iyy>0.25</iyy>
          <izz>0.05</izz>
          <ixy>0</ixy>
          <ixz>0</ixz>
          <iyz>0</iyz>
        </inertia>
      </inertial>
      <collision name="link1_collision">
        <geometry>
          <box>
            <size>0.16 0.16 0.9</size>
          </box>
        </geometry>
      </collision>
      <visual name="link1_visual">
        <material>
          <ambient>1.0 1.0 0.0 1</ambient> <diffuse>1.0 1.0 0.0 1</diffuse>
        </material>
        <geometry>
          <box>
            <size>0.16 0.16 0.9</size>
          </box>
        </geometry>
      </visual>
    </link>

    <!--2. link -->
    <link name="link2">
      <gravity>0</gravity>
      <pose>0 0 1.5 0 0 0</pose>
      <inertial>
        <mass>3.0</mass>
        <inertia>
          <ixx>0.25</ixx>
          <iyy>0.25</iyy>
          <izz>0.05</izz>
          <ixy>0</ixy>
          <ixz>0</ixz>
          <iyz>0</iyz>
        </inertia>
      </inertial>
      <collision name="link2_collision">
        <geometry>
          <box>
            <size>0.12 0.12 0.9</size>
          </box>
        </geometry>
      </collision>
      <visual name="link2_visual">
        <material>
          <ambient>0.0 0.0 0.5 1</ambient> <diffuse>0.0 0.0 0.5 1</diffuse>
        </material>
        <geometry>
          <box>
            <size>0.12 0.12 0.9</size>
          </box>
        </geometry>
      </visual>
    </link>

    <!--3. link -->
    <link name="link3">
      <gravity>0</gravity>
      <pose>0 0 2.4 0 0 0</pose>
      <inertial>
        <mass>3.0</mass>
        <inertia>
          <ixx>0.25</ixx>
          <iyy>0.25</iyy>
          <izz>0.05</izz>
          <ixy>0</ixy>
          <ixz>0</ixz>
          <iyz>0</iyz>
        </inertia>
      </inertial>
      <collision name="link3_collision">
        <geometry>
          <box>
            <size>0.08 0.08 0.9</size>
          </box>
        </geometry>
      </collision>
      <visual name="link3_visual">
        <material>
          <ambient>1.0 1.0 0.0 1</ambient> <diffuse>1.0 1.0 0.0 1</diffuse>
        </material>
        <geometry>
          <box>
            <size>0.08 0.08 0.9</size>
          </box>
        </geometry>
      </visual>
    </link>

    <joint name="world_yaw_joint" type="revolute">
  <parent>world</parent>
  <child>base_link</child>
  <pose>0 0 0 0 0 0</pose>

  <axis>
    <xyz>0 0 1</xyz>
    <limit>
      <lower>-3.1415</lower>
      <upper>3.1415</upper>
    </limit>
    <dynamics>
      <damping>60.0</damping>
    </dynamics>
  </axis>
</joint>

    <joint name="base_to_link1_fixed" type="fixed">
  <parent>base_link</parent>
  <child>link1</child>
</joint>

    <!-- J2: shoulder -->
    <joint name="j2_shoulder" type="revolute">
      <parent>link1</parent>
      <child>link2</child>
      <pose relative_to="link1">0 0 0.45 0 0 0</pose>
      <axis>
        <xyz>0 1 0</xyz>
        <limit>
          <lower>-1.5708</lower> 
          <upper>1.5708</upper>  
        </limit>
        <dynamics>
          <damping>60.0</damping>
        </dynamics>
      </axis>
    </joint>

    <!-- J3: elbow -->
    <joint name="j3_elbow" type="revolute">
      <parent>link2</parent>
      <child>link3</child>
      <pose relative_to="link2">0 0 0.45 0 0 0</pose>
      <axis>
        <xyz>0 1 0</xyz>
        <limit>
          <lower>-1.5708</lower>
          <upper>1.5708</upper>
        </limit>
        <dynamics>
          <damping>60.0</damping>
        </dynamics>
      </axis>
    </joint>
  

        <plugin name="gz::sim::systems::JointPositionController" filename="libgz-sim-joint-position-controller-system.so">
        <joint_name>world_yaw_joint</joint_name>
        <topic>/arm/j1/cmd_pos</topic>
        <p_gain>500</p_gain>
        <i_gain>0.1</i_gain>
        <d_gain>50.0</d_gain> 
        <i_max>1</i_max>
        <i_min>-1</i_min>
    </plugin>

    <plugin name="gz::sim::systems::JointPositionController" filename="libgz-sim-joint-position-controller-system.so">
        <joint_name>j2_shoulder</joint_name>
        <topic>/arm/j2/cmd_pos</topic>
        <p_gain>1000</p_gain> 
        <i_gain>0.1</i_gain>
        <d_gain>100.0</d_gain> <i_max>10</i_max>
        <i_min>-10</i_min>
    </plugin>

    <plugin name="gz::sim::systems::JointPositionController" filename="libgz-sim-joint-position-controller-system.so">
        <joint_name>j3_elbow</joint_name>
        <topic>/arm/j3/cmd_pos</topic>
        <p_gain>500</p_gain>
        <i_gain>0.1</i_gain>
        <d_gain>50.0</d_gain>
        <i_max>5</i_max>
        <i_min>-5</i_min>
    </plugin>
  </model>
</sdf>
